<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <link rel="icon" href="/svelte-crop-window/favicon.png" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta http-equiv="content-security-policy" content="">
		<link href="/svelte-crop-window/_app/immutable/assets/_page-50064c41.css" rel="stylesheet">
		<link rel="modulepreload" href="/svelte-crop-window/_app/immutable/start-2c7ded18.js">
		<link rel="modulepreload" href="/svelte-crop-window/_app/immutable/chunks/index-b7665181.js">
		<link rel="modulepreload" href="/svelte-crop-window/_app/immutable/chunks/singletons-ed77796e.js">
		<link rel="modulepreload" href="/svelte-crop-window/_app/immutable/chunks/paths-6cd3a76e.js">
		<link rel="modulepreload" href="/svelte-crop-window/_app/immutable/components/layout.svelte-74720335.js">
		<link rel="modulepreload" href="/svelte-crop-window/_app/immutable/modules/pages/_layout.ts-b8ee4d7c.js">
		<link rel="modulepreload" href="/svelte-crop-window/_app/immutable/chunks/_layout-1daba58d.js">
		<link rel="modulepreload" href="/svelte-crop-window/_app/immutable/components/pages/_page.svelte-a8d8d8ea.js"><!-- HTML_TAG_START --><style>pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-built_in,.hljs-class .hljs-title,.hljs-title.class_{color:#e6c07b}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><!-- HTML_TAG_END -->
        <style>
            html,
            body,
            p,
            ol,
            ul,
            li,
            dl,
            dt,
            dd,
            blockquote,
            figure,
            fieldset,
            legend,
            textarea,
            pre,
            iframe,
            hr,
            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                margin: 0;
                padding: 0;
            }

            ul {
                list-style: none;
            }

            button,
            input,
            select {
                margin: 0;
            }

            html {
                box-sizing: border-box;
                font-family: sans-serif;
                background-color: #167676;
                color: #f3f5e8;
            }

            a {
                color: #f3f5e8;
                font-weight: bold;
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }

            *,
            *::before,
            *::after {
                box-sizing: inherit;
            }

            img,
            video {
                height: auto;
                max-width: 100%;
            }

            iframe {
                border: 0;
            }

            table {
                border-collapse: collapse;
                border-spacing: 0;
            }

            td,
            th {
                padding: 0;
            }
        </style>
    </head>

    <body>
        <div>




<div class="container svelte-f66pw0"><div class="box svelte-f66pw0"><h1 class="svelte-f66pw0"><a href="https://github.com/sabine/svelte-crop-window" style="display:flex;align-items:center" class="svelte-f66pw0"><img src="/svelte-crop-window/logo.svg" alt="svelte media crop" style="height:5rem;margin-right:1rem" class="svelte-f66pw0">
                svelte-crop-window</a></h1>

        <p class="subtitle svelte-f66pw0">A crop window with touch and mouse gestures to zoom, pan and rotate an image or video.
        </p>
        <p class="svelte-f66pw0">Media snaps back to cover the crop area.</p></div>

    <div class="box svelte-f66pw0"><p class="svelte-f66pw0">Looking for contributions, code review and feedback! Feel free to open an issue on <a href="https://github.com/sabine/svelte-crop-window" class="svelte-f66pw0">the GitHub repository</a> or connect with me via the Svelte discord (sabine#8815).
        </p>

        <p class="svelte-f66pw0">This is still in an experimental stage. Changes to the API are to be expected. After
            v1.0.0, this package will strictly follow semantic versioning.
        </p>

        <p class="svelte-f66pw0">The code of this demo page is <a href="https://github.com/sabine/svelte-crop-window/blob/main/src/routes/%2Bpage.svelte" class="svelte-f66pw0">here</a>.
        </p></div>

    <div class="box svelte-f66pw0"><h2 id="with-controls" class="svelte-f66pw0"><a href="#with-controls" class="svelte-f66pw0">Example with controls</a></h2>

        <div style="height:20em; background: #164646" class="svelte-f66pw0">

<div class="outer svelte-1wgfjgv" style="--crop-window-height:0px;
--crop-window-width:0px;
--outer-height:0px;
--outer-width:0px;">
</div></div>

        <button class="svelte-f66pw0">image</button>

        <h3 class="svelte-f66pw0">Result</h3>
        <div style="position:relative;height:100px;width:100px; overflow:hidden; border-radius: 50%" class="svelte-f66pw0"><img style="transform: translateX(-50%) translateY(-50%) rotate(0deg);height: 0px;margin-left: 50px;margin-top: 50px;
                max-width:none;" src="/svelte-crop-window/hintersee-3601004.jpg" alt="result" class="svelte-f66pw0"></div>

        <h3 class="svelte-f66pw0">Aspect ratio</h3>
        <div class="svelte-f66pw0"><button class="svelte-f66pw0">8:1</button>
            <button class="svelte-f66pw0">16:9</button>
            <button class="svelte-f66pw0">4:3</button>
            <button class="svelte-f66pw0">1:1</button>
            <button class="svelte-f66pw0">3:4</button></div>

        <h3 class="svelte-f66pw0">Scale / Rotation / Position</h3>

        <div style="display:grid; grid-template-columns: auto 1fr;column-gap:2rem" class="svelte-f66pw0"><div class="svelte-f66pw0">scale</div>
            <div class="svelte-f66pw0"><input type="range" min="0.001" max="6" step="0.01" value="0" class="svelte-f66pw0">
                
                0</div>
            <div class="svelte-f66pw0">rotation</div>
            <div class="svelte-f66pw0"><input type="range" min="-180" max="180" step="1" value="0" class="svelte-f66pw0">
                0</div>
            <div class="svelte-f66pw0">x</div>
            <input type="number" step="0.01" class="svelte-f66pw0" value="0">

            <div class="svelte-f66pw0">y</div>
            <input type="number" step="0.01" class="svelte-f66pw0" value="0"></div>

        <h3 class="svelte-f66pw0">Colors</h3>
        <div style="display:grid; grid-template-columns: auto 1fr; column-gap:2rem; align-items:center;" class="svelte-f66pw0"><div class="svelte-f66pw0">overlay color</div>
            <input type="color" class="svelte-f66pw0" value="#167676">
            <div class="svelte-f66pw0">line color</div>
            <input type="color" class="svelte-f66pw0" value="#f3f5e8">
            <div class="svelte-f66pw0">background color</div>
            <input type="color" class="svelte-f66pw0" value="#164646"></div>
        <h3 class="svelte-f66pw0">Shape</h3>
        <div class="svelte-f66pw0"><select class="svelte-f66pw0"><option value="rect" class="svelte-f66pw0">rectangle</option><option value="round" class="svelte-f66pw0">round</option></select>
            <select class="svelte-f66pw0"><option value="true" class="svelte-f66pw0">show third lines</option><option value="false" class="svelte-f66pw0">don&#39;t show third lines</option></select></div></div>
    <div class="box svelte-f66pw0"><h2 id="minimal-code-example" class="svelte-f66pw0"><a href="#minimal-code-example" class="svelte-f66pw0">Minimal code example</a></h2>
        <div style="height:20em; background: #222" class="svelte-f66pw0">

<div class="outer svelte-1wgfjgv" style="--crop-window-height:0px;
--crop-window-width:0px;
--outer-height:0px;
--outer-width:0px;">
</div></div>
        <div class="svelte-f66pw0">
  
  <pre data-language="typescript" class=" svelte-4cqgwq"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-comment">// in script tag</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CropWindow</span>, defaultValue } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;svelte-crop-window&#x27;</span>;

<span class="hljs-keyword">let</span> <span class="hljs-attr">media</span>: <span class="hljs-title class_">Media</span> = {
    <span class="hljs-attr">content_type</span>: <span class="hljs-string">&#x27;image&#x27;</span>,
    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/svelte-crop-window/hintersee-3601004.jpg&#x27;</span>
};

<span class="hljs-keyword">let</span> value = { ...defaultValue };

<span class="hljs-comment">// in the template</span>
&lt;div style=&quot;height:20em; background: #222&quot;&gt;
    &lt;CropWindow bind:value {media} /&gt;
&lt;/div&gt;
<!-- HTML_TAG_END --></code></pre>
</div></div>

    <div class="box svelte-f66pw0"><h2 class="svelte-f66pw0">Props and defaults</h2>
        <a href="https://github.com/sabine/svelte-crop-window#props" class="svelte-f66pw0">See here</a>.

        
  
  <pre data-language="svelte" class=" svelte-4cqgwq"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;height:20em&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">CropWindow</span>
        <span class="hljs-attr">bind:value</span>
        {<span class="hljs-attr">media</span>}
        {<span class="hljs-attr">options</span>}
    /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<!-- HTML_TAG_END --></code></pre>


        
  
  <pre data-language="typescript" class=" svelte-4cqgwq"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-keyword">const</span> defaultOverlayOptions = {
    <span class="hljs-attr">overlay_color</span>: <span class="hljs-string">&#x27;#222222&#x27;</span>,
    <span class="hljs-attr">line_color</span>: <span class="hljs-string">&#x27;#FFFFFF&#x27;</span>,
    <span class="hljs-attr">show_third_lines</span>: <span class="hljs-literal">true</span>,
};

<span class="hljs-keyword">const</span> defaultOptions = {
    <span class="hljs-attr">shape</span>: <span class="hljs-string">&#x27;rect&#x27;</span>,
    <span class="hljs-attr">crop_window_margin</span>: <span class="hljs-number">10</span>,

    <span class="hljs-attr">overlay</span>: <span class="hljs-title class_">Overlay</span>,
    <span class="hljs-attr">overlay_options</span>: defaultOverlayOptions,
}
<!-- HTML_TAG_END --></code></pre>
</div>

    <div class="box svelte-f66pw0"><h2 id="how-to-crop" class="svelte-f66pw0"><a href="#how-to-crop" class="svelte-f66pw0">How to Crop</a></h2>

        <div style="position:relative;height:100px;width:100px; overflow:hidden; border-radius: 50%" class="svelte-f66pw0"><img style="transform: translateX(-50%) translateY(-50%) rotate(0deg);height: 0px;margin-left: 50px;margin-top: 50px;
                max-width:none;" src="/svelte-crop-window/hintersee-3601004.jpg" alt="result" class="svelte-f66pw0"></div>

        <h3 class="svelte-f66pw0">Display in HTML without actually cropping:</h3>

        
  
  <pre data-language="svelte" class=" svelte-4cqgwq"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">position:relative</span>; <span class="hljs-attr">overflow:hidden</span>;
        <span class="hljs-attr">height:</span>{<span class="hljs-attr">HEIGHT</span>}<span class="hljs-attr">px</span>; <span class="hljs-attr">width:</span>{<span class="hljs-attr">value.aspect</span> * <span class="hljs-attr">HEIGHT</span>}<span class="hljs-attr">px</span>;
        <span class="hljs-attr">border-radius:</span> { <span class="hljs-attr">options.shape</span> == <span class="hljs-string">&#x27;round&#x27;</span> ? &#x27;<span class="hljs-attr">50</span>%&#x27; <span class="hljs-attr">:</span> &#x27;<span class="hljs-attr">0</span>&#x27; }`}&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">video</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">transform:</span> <span class="hljs-attr">translateX</span>(<span class="hljs-attr">-50</span>%) <span class="hljs-attr">translateY</span>(<span class="hljs-attr">-50</span>%) <span class="hljs-attr">rotate</span>({<span class="hljs-attr">value.rotation</span> || <span class="hljs-attr">0</span>}<span class="hljs-attr">deg</span>);
    <span class="hljs-attr">height:</span> {(<span class="hljs-attr">value.scale</span> || <span class="hljs-attr">0.0</span>) * <span class="hljs-attr">HEIGHT</span>}<span class="hljs-attr">px</span>;
    <span class="hljs-attr">margin-left:</span> {<span class="hljs-attr">HEIGHT</span> * <span class="hljs-attr">value.aspect</span> / <span class="hljs-attr">2</span> + (<span class="hljs-attr">value.position.x</span> || <span class="hljs-attr">0</span>) * <span class="hljs-attr">HEIGHT</span>}<span class="hljs-attr">px</span>;
    <span class="hljs-attr">margin-top:</span> {<span class="hljs-attr">HEIGHT</span> / <span class="hljs-attr">2</span> + (<span class="hljs-attr">value.position.y</span> || <span class="hljs-attr">0</span>) * <span class="hljs-attr">HEIGHT</span>}<span class="hljs-attr">px</span>;
    <span class="hljs-attr">max-width:none</span>`}
        <span class="hljs-attr">src</span>=<span class="hljs-string">{url}</span>
    /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><!-- HTML_TAG_END --></code></pre>


        <h3 id="pseudo-code" class="svelte-f66pw0"><a href="#pseudo-code" class="svelte-f66pw0">Pseudo code to crop</a></h3>

        <ol class="svelte-f66pw0"><li class="svelte-f66pw0">Choose a <code class="svelte-f66pw0">target_height</code> and calculate the width for the cropped image:
                
  
  <pre data-language="typescript" class=" svelte-4cqgwq"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-keyword">let</span> target_width = target_height * value.<span class="hljs-property">aspect</span>;<!-- HTML_TAG_END --></code></pre>
</li>
            <li class="svelte-f66pw0">Calculate factor by which to scale:
                
  
  <pre data-language="typescript" class=" svelte-4cqgwq"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-keyword">let</span> s = value.<span class="hljs-property">scale</span> * target_height / media.<span class="hljs-property">height</span>;<!-- HTML_TAG_END --></code></pre>
</li>
            <li class="svelte-f66pw0">Scale media by <code class="svelte-f66pw0">s</code>:
                
  
  <pre data-language="typescript" class=" svelte-4cqgwq"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-keyword">let</span> resized_media = <span class="hljs-title function_">scale</span>(media, s);<!-- HTML_TAG_END --></code></pre>
</li>
            <li class="svelte-f66pw0">Rotate media by <code class="svelte-f66pw0">value.rotation</code>:
                
  
  <pre data-language="typescript" class=" svelte-4cqgwq"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-keyword">let</span> resized_and_rotated_media =
    <span class="hljs-title function_">rotate</span>(resized_media, value.<span class="hljs-property">rotation</span>);<!-- HTML_TAG_END --></code></pre>
</li>
            <li class="svelte-f66pw0">Calculate top left position of area to extract: 
  
  <pre data-language="typescript" class=" svelte-4cqgwq"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-keyword">let</span> left =
    (resized_and_rotated_media.<span class="hljs-property">width</span> - target_width) / <span class="hljs-number">2.0</span>
    - value.<span class="hljs-property">x</span> * target_height;
<span class="hljs-keyword">let</span> top =
    (resized_and_rotated_media.<span class="hljs-property">height</span> - target_height) / <span class="hljs-number">2.0</span>
    - value.<span class="hljs-property">y</span> * target_height;<!-- HTML_TAG_END --></code></pre>
</li>
            <li class="svelte-f66pw0">Extract area:
                
  
  <pre data-language="typescript" class=" svelte-4cqgwq"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-keyword">let</span> cropped_media =
    <span class="hljs-title function_">extract_area</span>(resized_and_rotated_media, left, top,
                 target_width, target_height);<!-- HTML_TAG_END --></code></pre>
</li></ol></div>

    <div class="box svelte-f66pw0"><h2 id="what-it-doesnt-do" class="svelte-f66pw0"><a href="#what-it-doesnt-do" class="svelte-f66pw0">What this component doesn&#39;t do</a></h2>
        <ol class="svelte-f66pw0"><li class="svelte-f66pw0">Does not modify/crop the image, you have to do that by whatever means make sense for
                your application.
            </li>
            <li class="svelte-f66pw0">Doesn&#39;t (yet) provide usable controls. Currently, you need to implement your own.
                <p class="svelte-f66pw0">Similar to the overlay, it would be nice to include some controls to make this
                    more usable out of the box. Contributions are very welcome.
                </p></li></ol></div>

    <div class="box svelte-f66pw0"><h2 class="svelte-f66pw0">Inspiration and Acknowledgements</h2>

        <p class="svelte-f66pw0">One big inspiration for this component was the Android library
            <a href="https://github.com/Yalantis/uCrop" class="svelte-f66pw0">uCrop by Yalantis</a>. What is particularly
            valuable is that the developers shared their thought process in
            <a href="https://yalantis.com/blog/how-we-created-ucrop-our-own-image-cropping-library-for-android/" class="svelte-f66pw0">this blog post</a>.
        </p>
        <p class="svelte-f66pw0">Another very helpful resource was <a href="https://github.com/ValentinH/svelte-easy-crop" class="svelte-f66pw0">svelte-easy-crop</a> which gave me a basic understanding of how to implement a crop window component in Svelte
            (and HTML/JS in general).
        </p>
        <p class="svelte-f66pw0">There&#39;s no code being reused between either of these components and this one (all
            calculations had to be recreated from textbook math).
        </p>

        <small class="svelte-f66pw0"><p class="svelte-f66pw0">Video from shantararam at pixabay: <a href="https://pixabay.com/videos/mountain-nature-snow-old-mountain-8837/" class="svelte-f66pw0">mountain-nature-snow-old-mountain-8837</a></p></small></div>
</div>


		<script type="module" data-sveltekit-hydrate="si5gq3">
			import { start } from "/svelte-crop-window/_app/immutable/start-2c7ded18.js";

			start({
				env: {},
				hydrate: {
					status: 200,
					error: null,
					node_ids: [0, 2],
					params: {},
					routeId: "",
					data: (function(a){return [a,a]}(null)),
					form: null
				},
				paths: {"base":"/svelte-crop-window","assets":"/svelte-crop-window"},
				target: document.querySelector('[data-sveltekit-hydrate="si5gq3"]').parentNode,
				trailing_slash: "never"
			});
		</script>
	</div>
    </body>
</html>
